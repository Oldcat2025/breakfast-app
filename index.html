<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ™¨æ›¦é£Ÿå…‰ - å¥å®çš„å…ƒæ°”æ—©é¤</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* --- æ ¸å¿ƒé…è‰²ä¸æ ·å¼ --- */
        :root {
            --bg-deep: #051F20;
            --bg-main: #0B2B26;
            --card-dark: #163832;
            --card-mid: #235347;
            --accent-green: #8EB69B;
            --text-light: #DAF1DE;
            --text-white: #FFFFFF;
            --shadow: 0 8px 20px rgba(0,0,0,0.4);
        }

        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(180deg, var(--bg-deep) 0%, var(--bg-main) 100%);
            color: var(--text-light);
            margin: 0; padding: 0; min-height: 100vh;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- é¡µé¢åˆ‡æ¢æ§åˆ¶ --- */
        .page { display: none; padding-bottom: 100px; animation: fadeIn 0.4s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- é¡¶éƒ¨å¯¼èˆª --- */
        .header { padding: 40px 20px 20px; text-align: center; }
        .date-badge { background: rgba(255,255,255,0.1); padding: 5px 15px; border-radius: 20px; font-size: 0.9rem; display: inline-block; margin-bottom: 10px; }
        
        .sub-header {
            background: var(--card-dark); padding: 15px 20px; display: flex; align-items: center; 
            justify-content: space-between; position: sticky; top: 0; z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .nav-btn {
            background: rgba(255,255,255,0.1); border: none; color: var(--text-white); padding: 8px 15px;
            border-radius: 20px; cursor: pointer; font-size: 0.9rem; display: flex; align-items: center; gap: 5px;
        }

        .section-title {
            padding: 10px 20px 20px; font-size: 1.2rem; font-weight: bold; display: flex; align-items: center; color: var(--text-white);
        }
        .section-title::before {
            content: ''; display: block; width: 5px; height: 20px; background: var(--accent-green); margin-right: 12px; border-radius: 3px;
        }

        /* --- é¦–é¡µï¼šçºµå‘æ¨èå¡ç‰‡ --- */
        .recipe-list-vertical { display: flex; flex-direction: column; gap: 25px; padding: 0 20px; }
        .recipe-card-large {
            background: var(--card-mid); border-radius: 24px; overflow: hidden; box-shadow: var(--shadow);
            position: relative; transition: transform 0.2s;
        }
        .recipe-card-large:active { transform: scale(0.98); }
        .recipe-img-large { height: 200px; width: 100%; object-fit: cover; background-color: #333; }
        .recipe-info { padding: 20px; }
        .recipe-name { font-size: 1.3rem; font-weight: bold; color: var(--text-white); margin-bottom: 8px; }
        .recipe-desc-short { font-size: 0.9rem; color: #ccc; margin-bottom: 12px; line-height: 1.4; }
        .recipe-tags { display: flex; gap: 8px; }
        .tag { font-size: 0.75rem; padding: 4px 10px; border-radius: 6px; background: rgba(0,0,0,0.3); color: var(--accent-green); }
        
        .recommend-badge {
            position: absolute; top: 15px; left: 15px; background: rgba(0,0,0,0.7); color: #fff;
            padding: 5px 12px; border-radius: 12px; font-size: 0.8rem; backdrop-filter: blur(4px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        .time-badge {
            position: absolute; top: 15px; right: 15px; background: var(--accent-green); color: #051F20;
            padding: 5px 12px; border-radius: 12px; font-weight: bold; font-size: 0.9rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        /* --- é¦–é¡µåº•éƒ¨å…¥å£ --- */
        .home-actions { display: flex; justify-content: center; gap: 40px; margin-top: 50px; padding-bottom: 20px; }
        .circle-btn-wrapper { display: flex; flex-direction: column; align-items: center; gap: 12px; }
        .circle-btn {
            width: 75px; height: 75px; border-radius: 50%;
            background: linear-gradient(135deg, var(--card-mid), var(--card-dark));
            border: 2px solid var(--accent-green);
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
            display: flex; align-items: center; justify-content: center;
            font-size: 1.8rem; color: var(--text-white); cursor: pointer; transition: transform 0.2s;
        }
        .circle-btn:active { transform: scale(0.9); }
        .btn-label { font-size: 0.9rem; color: var(--accent-green); font-weight: bold; }

        /* --- æ›´å¤šé£Ÿè°±ç½‘æ ¼ --- */
        .recipe-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 20px; }
        .grid-card { background: var(--card-mid); border-radius: 15px; overflow: hidden; display: flex; flex-direction: column; }
        .grid-card img { width: 100%; height: 110px; object-fit: cover; }
        .grid-card .info { padding: 12px; }
        .grid-card .title { font-size: 0.95rem; font-weight: bold; margin-bottom: 5px; color: var(--text-white); }

        /* --- è¯¦æƒ…å¼¹çª— --- */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; overflow-y: auto; backdrop-filter: blur(8px); }
        .modal-content { background: #F4F1EA; color: #333; margin: 15px; border-radius: 20px; overflow: hidden; min-height: 85vh; padding-bottom: 40px; }
        .ingredients-box { background: #fff; margin: 15px 0; padding: 15px; border-radius: 12px; box-shadow: inset 0 0 8px rgba(0,0,0,0.03); }
        .ing-grid { display: flex; gap: 20px; overflow-x: auto; padding-bottom: 5px; }
        .ing-item { display: flex; flex-direction: column; align-items: center; min-width: 65px; text-align: center; }
        .ing-img { width: 55px; height: 55px; border-radius: 50%; object-fit: cover; border: 3px solid #eee; margin-bottom: 5px; }
        .notebook-line { border-bottom: 1px dashed #ccc; padding: 12px 0; line-height: 1.6; font-size: 0.95rem; }
        
        /* --- æ’è¡Œæ¦œ --- */
        .leaderboard { margin: 20px; background: var(--card-dark); border-radius: 24px; padding: 25px 20px; }
        .rank-item { display: flex; align-items: center; margin-bottom: 15px; background: rgba(255,255,255,0.05); padding: 12px; border-radius: 15px; }
        .rank-avatar { width: 45px; height: 45px; border-radius: 50%; background: var(--accent-green); display: flex; align-items: center; justify-content: center; font-weight: bold; color: var(--bg-deep); margin-right: 15px; font-size: 1.2rem; }
        .rank-info { flex: 1; }
        .rank-name { font-weight: bold; color: var(--text-white); }
        .rank-score { font-size: 0.8rem; color: var(--accent-green); }
        
        /* å®¹é”™å›¾ */
        .img-error { display: flex; align-items: center; justify-content: center; background: #2c3e50; color: #ecf0f1; font-size: 0.8rem; height: 100%; width: 100%; }

    </style>
</head>
<body>

    <div id="page-home" class="page active">
        <div class="header">
            <div class="date-badge" id="currentDate"></div>
            <div style="font-size: 1.6rem; font-weight: bold; color: white; margin-bottom: 5px;">æ—©å®‰ï¼Œå¥å®ï¼</div>
            <div style="color: var(--accent-green); opacity: 0.9;">
                <i class="fas fa-seedling"></i> 10å¤©ä¸é‡æ ·å‘¨æœŸï¼šç¬¬ <span id="cycleDay">1</span> å¤©
            </div>
        </div>

        <div class="section-title">ä»Šæ—¥ä¼˜é€‰ (10åˆ†é’Ÿå¿«æ‰‹)</div>
        
        <div class="recipe-list-vertical" id="homeRecipeList"></div>

        <div class="home-actions">
            <div class="circle-btn-wrapper" onclick="showPage('page-rank')">
                <div class="circle-btn"><i class="fas fa-trophy"></i></div>
                <div class="btn-label">å¨ç¥æ¦œ</div>
            </div>
            <div class="circle-btn-wrapper" onclick="showPage('page-more')">
                <div class="circle-btn"><i class="fas fa-list-ul"></i></div>
                <div class="btn-label">æ‰€æœ‰é£Ÿè°±</div>
            </div>
        </div>
    </div>

    <div id="page-rank" class="page">
        <div class="sub-header">
            <button class="nav-btn" onclick="showPage('page-home')"><i class="fas fa-arrow-left"></i> è¿”å›</button>
            <span style="color:white; font-weight:bold;">å®¶åº­å¨ç¥æ¦œ</span>
            <div style="width:60px;"></div>
        </div>
        <div class="leaderboard">
            <div id="rankingList"></div>
            <input type="file" id="uploadInput" accept="image/*" style="display: none;" onchange="handleUpload(this)">
            <button style="width: 100%; padding: 18px; background: var(--accent-green); color: var(--bg-deep); border: none; border-radius: 16px; font-weight: bold; margin-top: 25px; font-size: 1rem; display:flex; align-items:center; justify-content:center; gap:10px; box-shadow: 0 5px 15px rgba(0,0,0,0.3);" onclick="document.getElementById('uploadInput').click()">
                <i class="fas fa-camera"></i> æ™’æ—©é¤æ‰“å¡
            </button>
        </div>
        <div style="text-align: center; margin-top: 30px;">
            <button class="nav-btn" style="background:var(--card-mid); margin:0 auto; padding: 10px 25px;" onclick="showPage('page-home')">
                <i class="fas fa-home"></i> å›åˆ°ä¸»ç•Œé¢
            </button>
        </div>
    </div>

    <div id="page-more" class="page">
        <div class="sub-header">
            <button class="nav-btn" onclick="showPage('page-home')"><i class="fas fa-arrow-left"></i> è¿”å›</button>
            <span style="color:white; font-weight:bold;">30å¤©é£Ÿè°±åº“</span>
            <div style="width:60px;"></div>
        </div>
        <div style="padding:15px 20px 0; font-size:0.9rem; color:#888;">è¿™é‡Œå±•ç¤ºäº†æ•°æ®åº“ä¸­æ‰€æœ‰å€™é€‰é£Ÿè°±ï¼Œæ¯æ—¥è‡ªåŠ¨è½®æ’­å‰3ä¸ªã€‚</div>
        <div class="recipe-grid" id="moreRecipeGrid"></div>
        <div style="text-align: center; margin-top: 20px;">
            <button class="nav-btn" style="background:var(--card-mid); margin:0 auto; padding: 10px 25px;" onclick="showPage('page-home')">
                <i class="fas fa-home"></i> å›åˆ°ä¸»ç•Œé¢
            </button>
        </div>
    </div>

    <div id="recipeModal" class="modal">
        <div style="position:absolute; top:20px; left:20px; z-index:1002;">
            <button class="nav-btn" style="background:rgba(0,0,0,0.6); backdrop-filter:blur(4px);" onclick="closeModal()">
                <i class="fas fa-arrow-left"></i> å…³é—­
            </button>
        </div>
        <div class="modal-content" id="modalContent"></div>
    </div>

    <script>
        // ================= æ ¸å¿ƒæ•°æ®åº“ï¼š30é“å¿«æ‰‹é£Ÿè°± =================
        // ä¸ºäº†ç¡®ä¿å›¾ç‰‡ç¨³å®šï¼Œéƒ¨åˆ†é£Ÿè°±å¤ç”¨äº†å¯é çš„åˆ†ç±»å›¾ç‰‡
        const RECIPE_DB = [
            // --- Day 1 ---
            { title: "åšæœç‰›å¥¶ç‡•éº¦ç²¥", time: "5 min", tags: ["è¡¥è„‘", "é’™"], img: "https://images.unsplash.com/photo-1517601278517-456741619dad?w=800&q=80", desc: "ç»å…¸è¡¥è„‘æ—©é¤ï¼Œç‰›å¥¶æ¸©çƒ­å³å¯ã€‚", ingredients: [{name:"ç‡•éº¦",img:""},{name:"ç‰›å¥¶",img:""}] },
            { title: "æ»‘è›‹ç‰›è‚‰å…¨éº¦å·", time: "8 min", tags: ["é•¿é«˜", "é“"], img: "https://images.unsplash.com/photo-1626132647523-66f5bf380027?w=800&q=80", desc: "ç‰›è‚‰è¡¥é“ï¼Œå…¨éº¦æŠ—é¥¿ã€‚", ingredients: [{name:"å…¨éº¦é¥¼",img:""},{name:"ç‰›è‚‰",img:""}] },
            { title: "è™¾ä»è¥¿å…°èŠ±çƒ˜è›‹", time: "10 min", tags: ["æŠ¤çœ¼", "ç»´C"], img: "https://images.unsplash.com/photo-1627308595229-7830a5c91f9f?w=800&q=80", desc: "è‰²å½©ä¸°å¯Œï¼Œä½è„‚é«˜è›‹ç™½ã€‚", ingredients: [{name:"è™¾ä»",img:""},{name:"è¥¿å…°èŠ±",img:""}] },
            
            // --- Day 2 ---
            { title: "é‡‘æªé±¼ç‰ç±³ä¸‰æ˜æ²»", time: "5 min", tags: ["ç›Šæ™º", "DHA"], img: "https://images.unsplash.com/photo-1550505096-279ea0112702?w=800&q=80", desc: "ç½å¤´é‡‘æªé±¼å³é£Ÿæ–¹ä¾¿ï¼Œå¯Œå«DHAã€‚", ingredients: [{name:"åå¸",img:""},{name:"é‡‘æªé±¼",img:""}] },
            { title: "è‘±æ²¹é˜³æ˜¥é¢(ç®€æ˜“ç‰ˆ)", time: "8 min", tags: ["æš–èƒƒ", "ç¢³æ°´"], img: "https://images.unsplash.com/photo-1612929633738-8fe44f7ec841?w=800&q=80", desc: "ä¸€æŠŠæŒ‚é¢ï¼Œä¸€å‹ºé…±æ²¹çŒªæ²¹ï¼Œæš–å¿ƒã€‚", ingredients: [{name:"æŒ‚é¢",img:""},{name:"å°è‘±",img:""}] },
            { title: "ç…è›‹åˆé¤è‚‰é¥­å›¢", time: "10 min", tags: ["èƒ½é‡", "æŠ—é¥¿"], img: "https://images.unsplash.com/photo-1563102325-1a3b37905d49?w=800&q=80", desc: "ç±³é¥­åŒ…ä¸Šæµ·è‹”ï¼Œä¸­é—´å¤¹ç…è›‹ã€‚", ingredients: [{name:"ç±³é¥­",img:""},{name:"æµ·è‹”",img:""}] },

            // --- Day 3 ---
            { title: "ç´«è–¯èŠå£«çƒ", time: "10 min", tags: ["ç²—ç²®", "é’™"], img: "https://images.unsplash.com/photo-1606525437679-037aca74a3e9?w=800&q=80", desc: "è’¸ç´«è–¯å‹æ³¥åŒ…èŠå£«ç‰‡ï¼Œå¹³åº•é”…ç…ã€‚", ingredients: [{name:"ç´«è–¯",img:""},{name:"èŠå£«",img:""}] },
            { title: "ç•ªèŒ„é¸¡è›‹ç–™ç˜©æ±¤", time: "10 min", tags: ["å¼€èƒƒ", "æ˜“æ¶ˆåŒ–"], img: "https://images.unsplash.com/photo-1547592166-23acbe34071b?w=800&q=80", desc: "é¢ç²‰æ…çµ®ï¼Œç•ªèŒ„æ±¤åº•ä¸€ç…®å³æˆã€‚", ingredients: [{name:"é¢ç²‰",img:""},{name:"ç•ªèŒ„",img:""}] },
            { title: "èŠ±ç”Ÿé…±é¦™è•‰åå¸", time: "3 min", tags: ["å¿«æ‰‹", "é’¾"], img: "https://images.unsplash.com/photo-1550614000-4b9519e07d72?w=800&q=80", desc: "æ— éœ€å¼€ç«ï¼ŒæŠ¹é…±åˆ‡é¦™è•‰ã€‚", ingredients: [{name:"åå¸",img:""},{name:"é¦™è•‰",img:""}] },

            // --- Day 4 ---
            { title: "é€Ÿå†»é¦„é¥¨+ç´«èœæ±¤", time: "8 min", tags: ["æ–¹ä¾¿", "æ±¤æ°´"], img: "https://images.unsplash.com/photo-1541696432-82c6da8ce7ea?w=800&q=80", desc: "å†°ç®±å¸¸å¤‡å°é¦„é¥¨ï¼ŒåŠ ç´«èœè™¾çš®ã€‚", ingredients: [{name:"é¦„é¥¨",img:""},{name:"ç´«èœ",img:""}] },
            { title: "ç‰›æ²¹æœæºå¿ƒè›‹åå¸", time: "6 min", tags: ["ä¼˜è´¨è„‚", "è„‘åŠ›"], img: "https://images.unsplash.com/photo-1525351484163-7529414395d8?w=800&q=80", desc: "ç‰›æ²¹æœæ£æ³¥ï¼Œç…ä¸ªå¤ªé˜³è›‹ã€‚", ingredients: [{name:"ç‰›æ²¹æœ",img:""},{name:"é¸¡è›‹",img:""}] },
            { title: "å°ç±³å—ç“œç²¥(éš”å¤œ)", time: "0 min", tags: ["å…»èƒƒ", "ç²—ç²®"], img: "https://images.unsplash.com/photo-1517601278517-456741619dad?w=800&q=80", desc: "ç”µé¥­ç…²é¢„çº¦åŠŸèƒ½ï¼Œæ—©ä¸Šç›´æ¥åƒã€‚", ingredients: [{name:"å°ç±³",img:""},{name:"å—ç“œ",img:""}] },

            // --- Day 5 ---
            { title: "é¸¡èƒ¸è‚‰è”¬èœæ²™æ‹‰", time: "8 min", tags: ["å‡è„‚", "é«˜è›‹ç™½"], img: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=800&q=80", desc: "ç…ç†Ÿé¸¡èƒ¸è‚‰ï¼Œæ‹Œå…¥ç”Ÿèœæ²¹é†‹æ±ã€‚", ingredients: [{name:"é¸¡èƒ¸",img:""},{name:"ç”Ÿèœ",img:""}] },
            { title: "çº¢ç³–å‘ç³•(åŠæˆå“)", time: "10 min", tags: ["ä¼ ç»Ÿ", "èƒ½é‡"], img: "https://images.unsplash.com/photo-1621655065166-73138356947c?w=800&q=80", desc: "è¶…å¸‚ä¹°å†·å†»å‘ç³•ï¼Œä¸Šæ±½è’¸10åˆ†é’Ÿã€‚", ingredients: [{name:"å‘ç³•",img:""},{name:"ç‰›å¥¶",img:""}] },
            { title: "é…¸å¥¶æ°´æœæç¢—", time: "3 min", tags: ["ç»´C", "ç›Šç”ŸèŒ"], img: "https://images.unsplash.com/photo-1488477181946-6428a0291777?w=800&q=80", desc: "æµ“ç¨ é…¸å¥¶åŠ åšæœç¢å’Œå½“å­£æ°´æœã€‚", ingredients: [{name:"é…¸å¥¶",img:""},{name:"è“è“",img:""}] },

            // --- Day 6 ---
            { title: "åŸ¹æ ¹æ‰‹æŠ“é¥¼", time: "5 min", tags: ["é¦™è„†", "è§£é¦‹"], img: "https://images.unsplash.com/photo-1626078299034-297eb040a43e?w=800&q=80", desc: "å†·å†»æ‰‹æŠ“é¥¼æ— éœ€æ²¹ï¼Œä¸¤é¢ç…é»„ã€‚", ingredients: [{name:"æ‰‹æŠ“é¥¼",img:""},{name:"åŸ¹æ ¹",img:""}] },
            { title: "è’¸çº¢è–¯+ç…®é¸¡è›‹", time: "10 min", tags: ["æç®€", "ä¼˜è´¨"], img: "https://images.unsplash.com/photo-1594970420448-6932a93361e6?w=800&q=80", desc: "ä¸€é”…å‡ºï¼Œå¥åº·æ— æ²¹çƒŸã€‚", ingredients: [{name:"çº¢è–¯",img:""},{name:"é¸¡è›‹",img:""}] },
            { title: "è‚‰æ¾è›‹é»„ä¸‰æ˜æ²»", time: "5 min", tags: ["å’¸é¦™", "èƒ½é‡"], img: "https://images.unsplash.com/photo-1484723091739-30a097e8f929?w=800&q=80", desc: "ä¸¤ç‰‡åå¸å¤¹è‚‰æ¾å’Œæ²™æ‹‰é…±ã€‚", ingredients: [{name:"è‚‰æ¾",img:""},{name:"åå¸",img:""}] },

            // --- Day 7 ---
            { title: "é»„æ²¹ç…é¦’å¤´ç‰‡", time: "5 min", tags: ["å‰©é¥­", "é¦™é…¥"], img: "https://images.unsplash.com/photo-1626202166699-b1d5c7075b14?w=800&q=80", desc: "å‰©é¦’å¤´åˆ‡ç‰‡è£¹è›‹æ¶²ç…è‡³é‡‘é»„ã€‚", ingredients: [{name:"é¦’å¤´",img:""},{name:"é¸¡è›‹",img:""}] },
            { title: "ç‰›å¥¶æ³¡ç‰ç±³ç‰‡", time: "2 min", tags: ["è¥¿å¼", "æé€Ÿ"], img: "https://images.unsplash.com/photo-1520025642999-566275e5262c?w=800&q=80", desc: "å®¶ä¹æ°ç‰ç±³ç‰‡å†²å†·ç‰›å¥¶ã€‚", ingredients: [{name:"ç‰ç±³ç‰‡",img:""},{name:"ç‰›å¥¶",img:""}] },
            { title: "å¿«æ‰‹è›‹ç‚’é¥­", time: "8 min", tags: ["å‰©é¥­", "ç®¡é¥±"], img: "https://images.unsplash.com/photo-1603133872878-684f208fb84b?w=800&q=80", desc: "å‰©ç±³é¥­åŠ ç«è…¿ä¸é¸¡è›‹å¿«ç‚’ã€‚", ingredients: [{name:"ç±³é¥­",img:""},{name:"ç«è…¿",img:""}] },

            // --- Day 8 ---
            { title: "å¢¨è¥¿å“¥é¸¡è‚‰å·", time: "8 min", tags: ["å¼‚åŸŸ", "ä¾¿æº"], img: "https://images.unsplash.com/photo-1626700051175-6818013e1d4f?w=800&q=80", desc: "å·é¥¼å¤¹ç”Ÿèœå’Œç†Ÿé¸¡æŸ³ã€‚", ingredients: [{name:"å·é¥¼",img:""},{name:"é¸¡æŸ³",img:""}] },
            { title: "æ—¥å¼å‘³å™Œæ±¤æ³¡é¥­", time: "5 min", tags: ["æš–èº«", "å‘é…µ"], img: "https://images.unsplash.com/photo-1547592180-85f173990554?w=800&q=80", desc: "å³é£Ÿå‘³å™Œæ±¤åŒ…å†²å¼€æ°´æ³¡é¥­ã€‚", ingredients: [{name:"å‘³å™Œ",img:""},{name:"ç±³é¥­",img:""}] },
            { title: "è“è“å±±è¯æ³¥", time: "10 min", tags: ["å¥è„¾", "ç”œå“"], img: "https://images.unsplash.com/photo-1567529684892-09290a1b2d05?w=800&q=80", desc: "é“æ£å±±è¯è’¸ç†Ÿå‹æ³¥æ·‹è“è“é…±ã€‚", ingredients: [{name:"å±±è¯",img:""},{name:"è“è“é…±",img:""}] },

            // --- Day 9 ---
            { title: "å¹³åº•é”…æŠ«è¨", time: "10 min", tags: ["ä¸°å¯Œ", "è¶£å‘³"], img: "https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?w=800&q=80", desc: "åå¸ç‰‡é“ºç•ªèŒ„é…±ã€é¦™è‚ å’ŒèŠå£«é—·åŒ–ã€‚", ingredients: [{name:"åå¸",img:""},{name:"èŠå£«ç¢",img:""}] },
            { title: "é»‘èŠéº»ç³Š(å†²æ³¡)", time: "3 min", tags: ["ä¹Œå‘", "ä¼ ç»Ÿ"], img: "https://images.unsplash.com/photo-1505253716371-bab3a29d6d09?w=800&q=80", desc: "å—æ–¹é»‘èŠéº»ç³Šå†²çƒ­ç‰›å¥¶ã€‚", ingredients: [{name:"èŠéº»ç²‰",img:""},{name:"ç‰›å¥¶",img:""}] },
            { title: "è¥¿è‘«èŠ¦é¸¡è›‹é¥¼", time: "10 min", tags: ["è”¬èœ", "è½¯å«©"], img: "https://images.unsplash.com/photo-1627308595229-7830a5c91f9f?w=800&q=80", desc: "è¥¿è‘«èŠ¦æ“¦ä¸æ‹Œé¢ç²‰é¸¡è›‹ç…ç†Ÿã€‚", ingredients: [{name:"è¥¿è‘«èŠ¦",img:""},{name:"é¢ç²‰",img:""}] },

            // --- Day 10 ---
            { title: "å¹¿ä¸œè‚ ç²‰(å®¶åº­ç‰ˆ)", time: "8 min", tags: ["é£å‘³", "æ¸…æ·¡"], img: "https://images.unsplash.com/photo-1555126634-323283e090fa?w=800&q=80", desc: "ç”¨è¶Šå—æ˜¥å·çš®æ³¡è½¯å·è›‹æ¶²è’¸ç†Ÿã€‚", ingredients: [{name:"æ˜¥å·çš®",img:""},{name:"é¸¡è›‹",img:""}] },
            { title: "æ³•å¼åå¸", time: "8 min", tags: ["é¦™ç”œ", "æ¾è½¯"], img: "https://images.unsplash.com/photo-1484723091739-30a097e8f929?w=800&q=80", desc: "åšåˆ‡åå¸æµ¸æ»¡è›‹å¥¶æ¶²ç…é»„ã€‚", ingredients: [{name:"åå¸",img:""},{name:"ç‰›å¥¶",img:""}] },
            { title: "é²œè™¾äº‘åé¢", time: "8 min", tags: ["æ¸¯å¼", "é²œç¾"], img: "https://images.unsplash.com/photo-1596797038530-2c107229654b?w=800&q=80", desc: "ç«¹å‡é¢(æˆ–æŒ‚é¢)ç…®ç†ŸåŠ å†·å†»äº‘åã€‚", ingredients: [{name:"é¢æ¡",img:""},{name:"äº‘å",img:""}] }
        ];

        // ç»Ÿä¸€è¡¥å……é€šç”¨æ­¥éª¤å’Œå¤‡ç”¨å›¾
        RECIPE_DB.forEach(r => {
            if(!r.steps) {
                r.steps = [
                    {text: "1. å‡†å¤‡é£Ÿæï¼Œæ¸…æ´—åˆ‡é…ã€‚", note: "â° é¢„è®¡è€—æ—¶ 2åˆ†é’Ÿ"},
                    {text: "2. æŒ‰ç…§æè¿°è¿›è¡ŒåŠ çƒ­æˆ–çƒ¹é¥ªã€‚", note: "ğŸ”¥ æ³¨æ„ç«å€™"},
                    {text: "3. è£…ç›˜ä¸Šæ¡Œï¼Œæ­é…ç‰›å¥¶æˆ–è±†æµ†ã€‚", note: "âœ… å®Œæˆ"}
                ];
            }
            // ç»™é£Ÿæè¡¥ä¸ªé€šç”¨å ä½å›¾
            r.ingredients.forEach(i => {
                if(!i.img) i.img = "https://images.unsplash.com/photo-1606914469725-e39c34bfdebe?w=100&q=80"; // é€šç”¨é£Ÿæå›¾
            });
        });

        // ================= æ™ºèƒ½è½®æ’­é€»è¾‘ =================
        const date = new Date();
        const startOfYear = new Date(date.getFullYear(), 0, 0);
        const diff = date - startOfYear;
        const oneDay = 1000 * 60 * 60 * 24;
        const dayOfYear = Math.floor(diff / oneDay); // è®¡ç®—ä»Šå¤©æ˜¯ä»Šå¹´çš„ç¬¬å‡ å¤©
        
        // æ ¸å¿ƒç®—æ³•ï¼š(å¤©æ•° * 3) % æ€»æ•° -> ä¿è¯å¾ªç¯ä¸”æ¯å¤©ä¸åŒ
        const totalRecipes = RECIPE_DB.length;
        const startIndex = (dayOfYear * 3) % totalRecipes;
        
        // è·å–ä»Šå¤©çš„3ä¸ªç´¢å¼• (å¤„ç†æ•°ç»„è¶Šç•Œå›ç¯)
        const dailyIndices = [
            startIndex,
            (startIndex + 1) % totalRecipes,
            (startIndex + 2) % totalRecipes
        ];

        // 10å¤©å‘¨æœŸè®¡ç®— (ä»…ç”¨äºæ˜¾ç¤º)
        const cycleDay = (dayOfYear % 10) + 1; 

        // ================= é¡µé¢æ¸²æŸ“ =================
        document.getElementById('currentDate').innerText = `${date.getFullYear()}.${date.getMonth()+1}.${date.getDate()} | å†œå†${getLunarDate()}`;
        document.getElementById('cycleDay').innerText = cycleDay;

        // 1. æ¸²æŸ“é¦–é¡µ (Vertical)
        const homeList = document.getElementById('homeRecipeList');
        dailyIndices.forEach((rIndex, i) => {
            const r = RECIPE_DB[rIndex];
            const onError = "this.onerror=null;this.parentElement.innerHTML='<div class=\"img-error\">ğŸ½ï¸ ç¾å‘³å›¾ç‰‡</div>';";
            homeList.innerHTML += `
                <div class="recipe-card-large" onclick="openRecipe(${rIndex})">
                    <div class="recommend-badge">ä»Šæ—¥æ¨è ${i + 1}</div>
                    <div class="time-badge">${r.time}</div>
                    <img src="${r.img}" class="recipe-img-large" alt="${r.title}" onerror="${onError}">
                    <div class="recipe-info">
                        <div class="recipe-name">${r.title}</div>
                        <div class="recipe-desc-short">${r.desc}</div>
                        <div class="recipe-tags">
                            ${r.tags.map(t => `<span class="tag">${t}</span>`).join('')}
                        </div>
                    </div>
                </div>
            `;
        });

        // 2. æ¸²æŸ“æ›´å¤š (Grid)
        const moreList = document.getElementById('moreRecipeGrid');
        RECIPE_DB.forEach((r, idx) => {
            const onError = "this.onerror=null;this.parentElement.innerHTML='<div class=\"img-error\">ğŸ½ï¸</div>';";
            moreList.innerHTML += `
                <div class="grid-card" onclick="openRecipe(${idx})">
                    <img src="${r.img}" alt="${r.title}" onerror="${onError}">
                    <div class="info">
                        <div class="title">${r.title}</div>
                        <div style="font-size:0.7rem; color:var(--accent-green);">${r.time}</div>
                    </div>
                </div>`;
        });

        // 3. è¯¦æƒ…é¡µé€»è¾‘
        function openRecipe(index) {
            const r = RECIPE_DB[index];
            const onError = "this.src='https://via.placeholder.com/100?text=Food'";
            let ingHtml = r.ingredients.map(ing => `
                <div class="ing-item">
                    <img src="${ing.img}" class="ing-img" onerror="${onError}">
                    <span class="ing-name">${ing.name}</span>
                </div>
            `).join('');

            let stepsHtml = r.steps.map(step => `
                <div class="notebook-line">
                    <strong>${step.text}</strong><br>
                    ${step.note ? `<span style="color:#d35400; font-size:0.9rem;">${step.note}</span>` : ''}
                </div>
            `).join('');

            const html = `
                <img src="${r.img}" style="width:100%; height:260px; object-fit:cover;">
                <div style="padding:20px; font-family: 'Comic Sans MS', cursive, sans-serif;">
                    <h2 style="color:#235347; margin-top:0;">${r.title}</h2>
                    <p style="background:rgba(142, 182, 155, 0.2); padding:10px; border-radius:8px; font-size:0.9rem;">${r.desc}</p>
                    
                    <h4 style="border-left:4px solid #235347; padding-left:10px; margin-bottom:15px;">æ‰€éœ€é£Ÿæ (åŸæ–™)</h4>
                    <div class="ingredients-box">
                        <div class="ing-grid">${ingHtml}</div>
                    </div>

                    <h4 style="border-left:4px solid #235347; padding-left:10px; margin-top:25px;">æ‰‹è´¦è®°å½• Â· åšæ³•</h4>
                    ${stepsHtml}

                    <div style="margin-top:40px; border-top:1px solid #ddd; padding-top:20px;">
                        <button class="nav-btn" style="background:#235347; width:100%; justify-content:center; padding:12px;" onclick="closeModal()">è¿”å›åˆ—è¡¨</button>
                    </div>
                </div>
            `;
            document.getElementById('modalContent').innerHTML = html;
            document.getElementById('recipeModal').style.display = 'block';
        }

        function closeModal() { document.getElementById('recipeModal').style.display = 'none'; }
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            window.scrollTo(0,0);
        }

        // --- ç®€å•è¾…åŠ©åŠŸèƒ½ ---
        function getLunarDate(){ return "å†¬æœˆ"; } // ç®€åŒ–ç‰ˆå†œå†
        function handleUpload(input) {
            if (input.files[0]) { alert("âœ… ä¸Šä¼ æˆåŠŸï¼å¨è‰ºå€¼+1"); renderRank(true); }
        }
        
        let users = [{ name: "å¦ˆå¦ˆ", score: 5 }, { name: "çˆ¸çˆ¸", score: 2 }, { name: "å¥å®", score: 3 }];
        function renderRank(addScore = false) {
            if(addScore) users[0].score++;
            users.sort((a, b) => b.score - a.score);
            let html = '';
            users.forEach((u, index) => {
                html += `
                    <div class="rank-item">
                        <div class="rank-avatar">${u.name[0]}</div>
                        <div class="rank-info">
                            <div class="rank-name">${u.name} ${index===0 ? 'ğŸ‘‘' : ''}</div>
                            <div class="rank-score">æœ¬å‘¨æ‰“å¡: ${u.score} æ¬¡</div>
                        </div>
                    </div>`;
            });
            document.getElementById('rankingList').innerHTML = html;
        }
        renderRank();

    </script>
</body>
</html>
